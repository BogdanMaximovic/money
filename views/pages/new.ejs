<% include ../partials/header %>
<% include ../pages/button %>
<script>
    $(document).ready(function() {
    $('#addingNew').modal('show') 
    var iconID = null;
    $('.aLink').on('click', function(event) {
      event.preventDefault();
      iconID = $(this).find('.iconImgId').attr('data-id');       
    });
    $('#success').hide();

      $('#save').click(function(e){
          e.preventDefault();
          var category = $('#name').val();
          var radioBtn = $('input[name=radio]:checked').val();
          var color = $('#color').val();

          var data = {};
          data.category = category;
          data.radioBtn = radioBtn;
          data.iconID = iconID;
          data.color = color;

          console.log(category,radioBtn,iconID,color)

          $.ajax({
            type: 'post',
            data: JSON.stringify(data),
            contentType: 'application/json',
            url: 'http://localhost:4200/addingNew',
            success: function(data) {
              console.log('success');
              console.log(JSON.stringify(data));
              }
            });
          $('#success').show();
        })
});
</script>
<div class="row text-center m-5" id="success">
  <div class="col m-auto">
    <p class="display-4 text-success">Category successfully saved</p>
  </div>
</div>
<!-- MODAL -->
<div class="modal fade" id="addingNew">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Adding new category</h5>
                <button class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">You can add whatever you like</div>
            <div class="modal-text">
                <form action="/addingNew" method="POST">
                    <div class="form-group m-1 p-1">
                        <label for="name">Category name</label>
                        <input class="form-control" type="text" id="name" placeholder="Enter new category">
                    </div>
                    <div class="form-group m-1 p-1">
                        <label for="radio" class="d-block">Expense or Income</label>
                        <input class="" type="radio" id="exp" name="radio" value="0">Expense
                        <input class="" type="radio" id="inc" name="radio" value="1">Income
                    </div>
                    <div class="form-group m-1 p-1">
                        <label for="name">Pick color</label>
                        <input class="form-control" type="color" name="favcolor" id="color" value="">
                    </div>
                    <div id="icons" class="form-group m-1 p-1">
                        <div class="modal-body">Select icon for category</div>
                        <% print.forEach(function(name){ %>
                        <a class="nav-link text-light d-inline aLink"><img src="<%= name.icons %>" class="d-inline p-1 text-left iconImgId" data-id="<%= name.icons_id %>"></a>
                        <% }) %>
                    </div>
                </form>
            </div>
            <div class="modal-footer m-auto">
                <a class="btn btn-success text-light" data-dismiss="modal" id="save">Save</a>
                <a class="btn btn-secondary text-light" data-dismiss="modal" id="close" href="/exp">Close</a>
            </div>
        </div>
    </div>
</div>
<% include ../partials/footer %>